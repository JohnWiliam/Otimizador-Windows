<Page x:Class="SystemOptimizer.Views.Pages.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:vm="clr-namespace:SystemOptimizer.ViewModels"
      xmlns:p="clr-namespace:SystemOptimizer.Properties"
      mc:Ignorable="d" 
      d:DesignHeight="650" d:DesignWidth="800"
      Title="{x:Static p:Resources.Settings_Title}">

    <ui:DynamicScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="24">
            
            <TextBlock Text="{x:Static p:Resources.Settings_General}" FontSize="20"
                       FontWeight="SemiBold" Margin="0,0,0,16"
                       Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>

            <ui:CardControl Icon="DarkTheme24" Margin="0,0,0,12">
                <ui:CardControl.Header>
                    <StackPanel>
                        <TextBlock Text="{x:Static p:Resources.Settings_Appearance}" FontWeight="Medium"/>
                        <TextBlock Text="{x:Static p:Resources.Settings_ThemeDesc}"
                                   FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                
                <ComboBox MinWidth="200"
                          ItemsSource="{Binding ThemeOptions}"
                          SelectedItem="{Binding CurrentThemeOption}"
                          DisplayMemberPath="Name" 
                          SelectedIndex="0" />
            </ui:CardControl>

            <ui:CardControl Icon="LocalLanguage24">
                <ui:CardControl.Header>
                    <StackPanel>
                        <TextBlock Text="{x:Static p:Resources.Settings_Language}" FontWeight="Medium"/>
                        <TextBlock Text="{x:Static p:Resources.Settings_LanguageDesc}"
                                   FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                <ComboBox MinWidth="200" 
                          ItemsSource="{Binding Languages}" 
                          SelectedItem="{Binding CurrentLanguage}"
                          SelectedIndex="0"/>
            </ui:CardControl>

            <TextBlock Text="{x:Static p:Resources.Settings_Behavior}" FontSize="20"
                       FontWeight="SemiBold" Margin="0,24,0,16"
                       Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>

            <ui:CardControl Icon="SlideHide24">
                <ui:CardControl.Header>
                    <StackPanel>
                        <TextBlock Text="{x:Static p:Resources.Settings_Persistence}" FontWeight="Medium"/>
                        <TextBlock Text="{x:Static p:Resources.Settings_PersistenceDesc}"
                                   FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                
                <ui:ToggleSwitch IsChecked="{Binding IsPersistenceEnabled}" />
            </ui:CardControl>

            <ui:CardControl Icon="Pin24" Margin="0,12,0,0">
                <ui:CardControl.Header>
                    <StackPanel>
                        <TextBlock Text="{x:Static p:Resources.Settings_KeepInstalled}" FontWeight="Medium"/>
                        <TextBlock Text="{x:Static p:Resources.Settings_KeepInstalledDesc}"
                                   FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                
                <ui:ToggleSwitch IsChecked="{Binding IsKeepInstalledEnabled}" />
            </ui:CardControl>

            <TextBlock Text="{x:Static p:Resources.Settings_Update}" FontSize="20"
                       FontWeight="SemiBold" Margin="0,24,0,16"
                       Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>

            <ui:CardControl Icon="ArrowSync24">
                <ui:CardControl.Header>
                    <StackPanel>
                        <TextBlock Text="{x:Static p:Resources.Settings_UpdateSystemVersion}" FontWeight="Medium"/>
                        <TextBlock Text="{x:Static p:Resources.Settings_UpdateCheckDesc}"
                                   FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </ui:CardControl.Header>
                
                <ui:Button Command="{Binding CheckForUpdatesCommand}" 
                           Appearance="Primary" MinWidth="150">
                    <Grid>
                        <StackPanel Orientation="Horizontal" Visibility="{Binding IsCheckingForUpdates, Converter={x:Static ui:Converters.BooleanToVisibilityConverter.Inverse}}">
                            <ui:SymbolIcon Symbol="ArrowDownload24" Margin="0,0,8,0"/>
                            <TextBlock Text="{x:Static p:Resources.Btn_CheckUpdate}"/>
                        </StackPanel>
                        <ui:ProgressRing IsIndeterminate="True" 
                                         Visibility="{Binding IsCheckingForUpdates, Converter={x:Static ui:Converters.BooleanToVisibilityConverter.Instance}}"
                                         Width="20" Height="20" />
                    </Grid>
                </ui:Button>
            </ui:CardControl>

        </StackPanel>
    </ui:DynamicScrollViewer>
</Page>
