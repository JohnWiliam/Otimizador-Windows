<Page x:Class="SystemOptimizer.Views.Pages.CleanupPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:p="clr-namespace:SystemOptimizer.Properties"
      mc:Ignorable="d"
      d:DesignHeight="700"
      d:DesignWidth="900"
      x:Name="RootPage"
      Title="CleanupPage"
      FontFamily="Segoe UI">

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0"
                   Text="{x:Static p:Resources.Cleanup_Title}"
                   Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                   FontSize="26"
                   FontWeight="SemiBold"
                   Margin="0,0,0,16" />

        <ui:DynamicScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <ui:Card Margin="0,0,0,12" Padding="16">
                    <StackPanel>
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <ui:SymbolIcon Grid.Column="0" Symbol="Broom24" FontSize="22" Margin="0,2,12,0" />

                            <StackPanel Grid.Column="1">
                                <TextBlock Text="{x:Static p:Resources.Cleanup_CacheTitle}"
                                           FontSize="15"
                                           FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextFillColorPrimaryBrush}" />
                                <TextBlock Text="{x:Static p:Resources.Cleanup_CacheDesc}"
                                           Margin="0,4,0,0"
                                           FontSize="13"
                                           TextWrapping="Wrap"
                                           Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                            </StackPanel>
                        </Grid>

                        <UniformGrid Columns="2" Rows="4" Margin="0,0,0,8">
                            <CheckBox Content="{x:Static p:Resources.Cleanup_OptionTemp}"
                                      IsChecked="{Binding CleanTemp, ElementName=RootPage}"
                                      Margin="0,0,8,10" />
                            <CheckBox Content="{x:Static p:Resources.Cleanup_OptionSystemTemp}"
                                      IsChecked="{Binding CleanSystemTemp, ElementName=RootPage}"
                                      Margin="0,0,8,10" />
                            <CheckBox Content="{x:Static p:Resources.Cleanup_OptionPrefetch}"
                                      IsChecked="{Binding CleanPrefetch, ElementName=RootPage}"
                                      Margin="0,0,8,10" />
                            <CheckBox Content="{x:Static p:Resources.Cleanup_OptionWindowsUpdate}"
                                      IsChecked="{Binding CleanWindowsUpdate, ElementName=RootPage}"
                                      Margin="0,0,8,10" />
                            <CheckBox Content="{x:Static p:Resources.Cleanup_OptionBrowser}"
                                      IsChecked="{Binding CleanBrowser, ElementName=RootPage}"
                                      Margin="0,0,8,10" />
                            <CheckBox Content="{x:Static p:Resources.Cleanup_OptionDNS}"
                                      IsChecked="{Binding CleanDns, ElementName=RootPage}"
                                      Margin="0,0,8,10" />
                            <CheckBox IsChecked="{Binding CleanRecycleBin, ElementName=RootPage}"
                                      Margin="0,0,8,10">
                                <StackPanel Orientation="Horizontal">
                                    <ui:SymbolIcon Symbol="Delete20" Margin="0,0,6,0" Foreground="#D46A6A" />
                                    <TextBlock Text="{x:Static p:Resources.Cleanup_OptionRecycleBin}" />
                                </StackPanel>
                            </CheckBox>
                        </UniformGrid>

                        <WrapPanel>
                            <ui:Button Appearance="Primary"
                                       Icon="{ui:SymbolIcon Search24}"
                                       Content="{x:Static p:Resources.Cleanup_ActionAnalyze}"
                                       Command="{Binding AnalyzeCommand, ElementName=RootPage}"
                                       IsEnabled="{Binding CanAnalyze, ElementName=RootPage}"
                                       Margin="0,0,8,0" />

                            <ui:Button Appearance="Primary"
                                       Icon="{ui:SymbolIcon Delete24}"
                                       Content="{x:Static p:Resources.Cleanup_ActionClean}"
                                       Command="{Binding CleanupSelectedCommand, ElementName=RootPage}"
                                       IsEnabled="{Binding CanCleanup, ElementName=RootPage}"
                                       Margin="0,0,8,0" />

                            <ui:Button Appearance="Secondary"
                                       Icon="{ui:SymbolIcon Dismiss24}"
                                       Content="{x:Static p:Resources.Cleanup_ActionCancel}"
                                       Command="{Binding CancelCommand, ElementName=RootPage}"
                                       Visibility="{Binding CancelVisibility, ElementName=RootPage}" />
                        </WrapPanel>
                    </StackPanel>
                </ui:Card>

                <ui:Card Margin="0,0,0,12" Padding="16">
                    <StackPanel>
                        <TextBlock Text="{x:Static p:Resources.Cleanup_ScanSummaryTitle}" FontWeight="SemiBold" Margin="0,0,0,10" />

                        <Border Padding="12"
                                CornerRadius="6"
                                Background="{DynamicResource ControlFillColorSecondaryBrush}"
                                Visibility="{Binding EmptySummaryVisibility, ElementName=RootPage}">
                            <TextBlock Text="{x:Static p:Resources.Cleanup_ScanEmptyState}"
                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                       TextWrapping="Wrap" />
                        </Border>

                        <ItemsControl ItemsSource="{Binding ScanResults, ElementName=RootPage}"
                                      Visibility="{Binding SummaryVisibility, ElementName=RootPage}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <CheckBox Grid.Column="0" IsChecked="{Binding IsSelected}" Margin="0,0,10,0" VerticalAlignment="Center" />
                                        <TextBlock Grid.Column="1" Text="{Binding DisplayName}" VerticalAlignment="Center" />
                                        <TextBlock Grid.Column="2" Text="{Binding ItemsLabel}" Margin="0,0,12,0" VerticalAlignment="Center"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
                                        <TextBlock Grid.Column="3" Text="{Binding HumanSize}" FontWeight="SemiBold" VerticalAlignment="Center" />
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Margin="0,8,0,4" Text="{Binding DataContext.CleanupProgressCategory, ElementName=RootPage}" />
                        <ProgressBar Height="8" Minimum="0" Maximum="100" Value="{Binding DataContext.CleanupProgressPercentage, ElementName=RootPage}" />
                        <TextBlock Margin="0,4,0,0"
                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                   Text="{Binding CleanupProcessedItemsLabel, ElementName=RootPage}" />
                    </StackPanel>
                </ui:Card>

                <ui:Card Padding="0" MinHeight="230">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0"
                                Padding="16,10"
                                Background="{DynamicResource ControlFillColorSecondaryBrush}"
                                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                                BorderThickness="0,0,0,1"
                                CornerRadius="4,4,0,0">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <ui:SymbolIcon Symbol="CodeText20" Margin="0,0,10,0" FontSize="16" />
                                <TextBlock Text="{x:Static p:Resources.Cleanup_LogTitle}"
                                           Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                           FontWeight="Medium"
                                           FontSize="13" />
                            </StackPanel>
                        </Border>

                        <RichTextBox Grid.Row="1"
                                     x:Name="LogOutput"
                                     IsReadOnly="True"
                                     Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     Padding="16"
                                     VerticalScrollBarVisibility="Auto"
                                     VerticalContentAlignment="Top"
                                     FontFamily="Segoe UI"
                                     FontSize="12">
                            <FlowDocument PagePadding="0" TextAlignment="Left" FontFamily="Segoe UI" />
                        </RichTextBox>
                    </Grid>
                </ui:Card>
            </StackPanel>
        </ui:DynamicScrollViewer>
    </Grid>
</Page>
